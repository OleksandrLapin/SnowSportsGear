import{a as J}from"./chunk-CH525GQJ.js";import{a as I,b as K,c as Q}from"./chunk-457W2FQK.js";import{b as H,c as T}from"./chunk-HZOM3H66.js";import{a as X}from"./chunk-Q4DC7VTO.js";import{a as L,d as N,h as q,i as W}from"./chunk-FJ7QX5M6.js";import"./chunk-YTDSK5ZT.js";import{a as U,d as z}from"./chunk-TWCHZGE4.js";import{da as j,i as A,jb as G,k as P,l as $}from"./chunk-3VDJTOIS.js";import{$a as B,Db as R,Gb as C,Hb as b,Ib as e,Jb as t,Kb as k,Ob as g,Rb as S,Tb as u,Tc as E,Uc as D,Wb as M,Xb as V,bc as i,cb as o,cc as m,dc as v,jc as w,ka as s,nc as p,oa as h,oc as x,pc as y,wb as O,xa as f,ya as _,yb as F}from"./chunk-XXTPASVJ.js";var ie=(d,n)=>n.productId+"-"+n.size;function re(d,n){if(d&1){let r=g();k(0,"app-star-rating",29),e(1,"span",30),i(2),p(3,"date"),t(),e(4,"button",31),S("click",function(){f(r);let a=u().$implicit,c=u(2);return _(c.openReviewDialog(a))}),i(5,"Edit review"),t()}if(d&2){let r=u().$implicit;F("value",r.reviewRating),o(2),m(y(3,2,r.reviewDate,"mediumDate"))}}function ne(d,n){if(d&1){let r=g();e(0,"button",32),S("click",function(){f(r);let a=u().$implicit,c=u(2);return _(c.openReviewDialog(a))}),i(1,"Write a review"),t()}}function oe(d,n){if(d&1){let r=g();e(0,"button",32),S("click",function(){f(r);let a=u().$implicit,c=u(2);return _(c.openReviewDialog(a))}),i(1,"Edit review"),t()}}function de(d,n){if(d&1&&(e(0,"tr")(1,"td",22)(2,"div",23),k(3,"img",24),e(4,"span"),i(5),t()(),e(6,"div",25),O(7,re,6,5)(8,ne,2,0,"button",26)(9,oe,2,0,"button",26),t()(),e(10,"td",27),i(11),t(),e(12,"td",27),i(13),t(),e(14,"td",28),i(15),p(16,"currency"),t()()),d&2){let r=n.$implicit;o(3),M("src",r.pictureUrl,B),o(2),m(r.productName),o(2),R(r.reviewRating?7:r.canReview?8:r.reviewId?9:-1),o(4),m(r.size),o(2),v("x",r.quantity,""),o(2),m(x(16,6,r.price))}}function ae(d,n){if(d&1){let r=g();e(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"h2",3),i(4),t(),e(5,"button",4),S("click",function(){f(r);let a=u();return _(a.onReturnClick())}),i(6),t()(),e(7,"div",5)(8,"div",6)(9,"h4",7),i(10,"Billing and delivery information"),t(),e(11,"dl")(12,"dt",8),i(13,"Shipping address"),t(),e(14,"dd",9),i(15),p(16,"address"),t()(),e(17,"dl")(18,"dt",8),i(19,"Payment info"),t(),e(20,"dd",9),i(21),p(22,"paymentCard"),t()()(),e(23,"div",6)(24,"h4",7),i(25,"Order details"),t(),e(26,"dl")(27,"dt",8),i(28,"Email address"),t(),e(29,"dd",9),i(30),t()(),e(31,"dl")(32,"dt",8),i(33,"Order status"),t(),e(34,"dd",9),i(35),t()(),e(36,"dl")(37,"dt",8),i(38,"Order date"),t(),e(39,"dd",9),i(40),p(41,"date"),t()()()(),e(42,"div",10)(43,"div",11)(44,"table",12)(45,"tbody",13),C(46,de,17,8,"tr",null,ie),t()()()(),e(48,"div",14)(49,"p",15),i(50,"Order summary"),t(),e(51,"div",16)(52,"div",6)(53,"dl",17)(54,"dt",18),i(55,"Subtotal"),t(),e(56,"dd",19),i(57),p(58,"currency"),t()(),e(59,"dl",17)(60,"dt",18),i(61,"Discount"),t(),e(62,"dd",20),i(63),p(64,"currency"),t()(),e(65,"dl",17)(66,"dt",18),i(67,"Delivery fee"),t(),e(68,"dd",19),i(69),p(70,"currency"),t()()(),e(71,"dl",21)(72,"dt",18),i(73,"Total"),t(),e(74,"dd",19),i(75),p(76,"currency"),t()()()()()()}if(d&2){let r=u();o(4),v("Order summary for order #",r.order.id,""),o(2),m(r.buttonText),o(9),m(x(16,11,r.order.shippingAddress)),o(6),m(x(22,13,r.order.paymentSummary)),o(9),m(r.order.buyerEmail),o(5),m(r.order.status),o(5),m(y(41,15,r.order.orderDate,"medium")),o(6),b(r.order.orderItems),o(11),v(" ",x(58,18,r.order.subtotal)," "),o(6),v(" -",x(64,20,r.order.discount)," "),o(6),v(" ",x(70,22,r.order.shippingPrice)," "),o(6),v(" ",x(76,24,r.order.total)," ")}}var Y=(()=>{let n=class n{constructor(){this.orderService=s(I),this.activatedRoute=s(A),this.accountService=s(H),this.adminService=s(X),this.router=s(P),this.reviewService=s(W),this.dialog=s(N),this.snackbar=s(G),this.buttonText=this.accountService.isAdmin()?"Return to admin":"Return to orders"}ngOnInit(){this.loadOrder()}onReturnClick(){this.accountService.isAdmin()?this.router.navigateByUrl("/admin"):this.router.navigateByUrl("/orders")}loadOrder(){let l=this.activatedRoute.snapshot.paramMap.get("id");if(!l)return;(this.accountService.isAdmin()?this.adminService.getOrder(+l):this.orderService.getOrderDetailed(+l)).subscribe({next:c=>this.order=c,error:()=>this.order=void 0})}openReviewDialog(l){let a=l.reviewId?this.reviewService.getMyReview(l.productId):null;a?a.subscribe({next:c=>this.launchReviewDialog(l,c),error:()=>this.launchReviewDialog(l)}):this.launchReviewDialog(l)}launchReviewDialog(l,a){this.dialog.open(J,{width:"520px",data:{productId:l.productId,productName:l.productName,orderId:this.order?.id,review:a}}).afterClosed().subscribe({next:ee=>{ee&&(this.snackbar.success(a?"Review updated":"Review added"),this.loadOrder())}})}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=h({type:n,selectors:[["app-order-detailed"]],standalone:!0,features:[w],decls:1,vars:1,consts:[[1,"bg-white","py-8","shadow-md","max-w-screen-lg","mx-auto"],[1,"px-4","w-full"],[1,"flex","justify-between","items-center","align-middle"],[1,"text-2xl","text-center","font-semibold"],["mat-stroked-button","",3,"click"],[1,"mt-8","py-3","border-t","border-gray-200","flex","gap-16"],[1,"space-y-2"],[1,"text-lg","font-semibold"],[1,"font-medium"],[1,"mt-1","font-light"],[1,"mt-4"],[1,"border-y","border-gray-200"],[1,"w-full","text-center"],[1,"divide-y","divide-gray-200"],[1,"space-y-4","rounded-lg","border-y","border-gray-200","p-4","bg-white"],[1,"text-xl","font-semibold"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"font-medium","text-gray-500"],[1,"font-medium","text-gray-900"],[1,"font-medium","text-green-500"],[1,"flex","items-center","justify-between","gap-4","border-t","border-gray-200","pt-2"],[1,"py-4"],[1,"flex","items-center","gap-4"],["alt","product image",1,"w-10","h-10",3,"src"],[1,"mt-2","flex","items-center","gap-3","text-xs","text-gray-700"],["mat-stroked-button","","color","primary",1,"px-2"],[1,"p-4"],[1,"p-4","text-right"],["size","sm",3,"value"],[1,"text-gray-500"],["mat-button","","color","primary",1,"px-2",3,"click"],["mat-stroked-button","","color","primary",1,"px-2",3,"click"]],template:function(a,c){a&1&&O(0,ae,77,26,"mat-card",0),a&2&&R(c.order?0:-1)},dependencies:[z,U,j,E,D,K,Q,q,L]});let d=n;return d})();var le=(d,n)=>n.id;function me(d,n){if(d&1&&(e(0,"tr",10)(1,"th",11),i(2),t(),e(3,"td"),i(4),p(5,"date"),t(),e(6,"td"),i(7),p(8,"currency"),t(),e(9,"td"),i(10),t()()),d&2){let r=n.$implicit;V("routerLink","/orders/",r.id,""),o(2),v("# ",r.id,""),o(2),m(y(5,6,r.orderDate,"medium")),o(3),m(x(8,9,r.total)),o(3),m(r.status)}}var Z=(()=>{let n=class n{constructor(){this.orderService=s(I),this.orders=[]}ngOnInit(){this.orderService.getOrdersForUser().subscribe({next:l=>this.orders=l})}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=h({type:n,selectors:[["app-order"]],standalone:!0,features:[w],decls:19,vars:0,consts:[[1,"mx-auto","mt-32"],[1,"font-semibold","text-2xl","mb-6","text-center"],[1,"flex","flex-col"],[1,"w-full"],[1,"min-w-full","divide-y","divide-gray-200","cursor-pointer"],[1,"bg-gray-50"],[1,"uppercase","text-gray-600","text-sm"],[1,"text-center","px-6","py-3"],[1,"text-left"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-100",3,"routerLink"],[1,"px-6","py-3"]],template:function(a,c){a&1&&(e(0,"div",0)(1,"h2",1),i(2,"My orders"),t(),e(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead",5)(7,"tr",6)(8,"th",7),i(9,"Order"),t(),e(10,"th",8),i(11,"Date"),t(),e(12,"th",8),i(13,"Total"),t(),e(14,"th",8),i(15,"Status"),t()()(),e(16,"tbody",9),C(17,me,11,11,"tr",10,le),t()()()()()),a&2&&(o(17),b(c.orders))},dependencies:[$,E,D]});let d=n;return d})();var je=[{path:"",component:Z,canActivate:[T]},{path:":id",component:Y,canActivate:[T]}];export{je as orderRoutes};
