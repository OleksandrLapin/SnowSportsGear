import{a as j,b as B,c as q,e as O,f as U,g as z,h as G,i as $}from"./chunk-CDZYAJHF.js";import{Ga as I,Ia as D,La as F,Ma as k,Oa as E,Qa as d,Sa as T,_a as A,ca as R,cb as L,db as N,ea as y,fb as V,gb as H,hb as P,ib as W}from"./chunk-NLYTDXKY.js";import{Db as x,Ib as e,Jb as i,Kb as b,Rb as g,Vc as C,bc as a,cb as n,db as w,dc as s,jc as S,ka as c,oa as _,wb as M,yb as f}from"./chunk-FFTV7VFC.js";function J(u,l){u&1&&(e(0,"span",6),a(1,"Select a rating"),i())}var ct=(()=>{let l=class l{constructor(o){this.data=o,this.dialogRef=c(B),this.fb=c(N),this.reviewService=c($),this.snackbar=c(W),this.submitting=!1,this.form=this.fb.group({rating:[this.data.review?.rating??0,[d.required,d.min(1),d.max(5)]],title:[this.data.review?.title??"",[d.maxLength(150)]],content:[this.data.review?.content??"",[d.maxLength(1e3)]]})}setRating(o){this.form.get("rating")?.setValue(o)}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}let o={rating:this.form.value.rating??0,title:this.form.value.title??null,content:this.form.value.content??null,orderId:this.data.orderId??null},r=this.data.review?this.reviewService.updateReview(this.data.productId,this.data.review.id,o):this.reviewService.createReview(this.data.productId,o);this.submitting=!0,r.subscribe({next:t=>{this.snackbar.success(this.data.review?"Review updated":"Review added"),this.dialogRef.close(t)},error:t=>{this.submitting=!1,this.snackbar.error(t?.error||"Unable to save review")}})}};l.\u0275fac=function(r){return new(r||l)(w(q))},l.\u0275cmp=_({type:l,selectors:[["app-review-form-dialog"]],standalone:!0,features:[S],decls:27,vars:10,consts:[["mat-dialog-title","",1,"text-lg","font-semibold"],[1,"block","text-sm","font-normal","text-gray-500"],[1,"space-y-4"],[1,"flex","items-center","gap-3"],[1,"text-sm","font-medium","text-gray-700"],["size","md",3,"valueChange","value","readonly"],[1,"text-sm","text-red-600"],["appearance","outline",1,"w-full"],["matInput","","formControlName","title","maxlength","150"],["align","end"],["matInput","","rows","4","formControlName","content","maxlength","1000"],["mat-button","","type","button",3,"click","disabled"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"]],template:function(r,t){if(r&1&&(e(0,"h2",0),a(1),e(2,"span",1),a(3),i()(),e(4,"mat-dialog-content",2)(5,"div",3)(6,"span",4),a(7,"Rating *"),i(),e(8,"app-star-rating",5),g("valueChange",function(m){return t.setRating(m)}),i(),M(9,J,2,0,"span",6),i(),e(10,"mat-form-field",7)(11,"mat-label"),a(12,"Title (optional)"),i(),b(13,"input",8),e(14,"mat-hint",9),a(15),i()(),e(16,"mat-form-field",7)(17,"mat-label"),a(18,"Description (optional)"),i(),b(19,"textarea",10),e(20,"mat-hint",9),a(21),i()()(),e(22,"mat-dialog-actions",9)(23,"button",11),g("click",function(){return t.dialogRef.close()}),a(24,"Cancel"),i(),e(25,"button",12),g("click",function(){return t.submit()}),a(26),i()()),r&2){let p,m,v,h;n(),s(" ",t.data.review?"Edit your review":"Write a review"," "),n(2),s("for ",t.data.productName,""),n(5),f("value",((p=t.form.get("rating"))==null?null:p.value)||0)("readonly",!1),n(),x((m=t.form.get("rating"))!=null&&m.invalid&&((m=t.form.get("rating"))!=null&&m.touched)?9:-1),n(6),s("",((v=t.form.get("title"))==null||v.value==null?null:v.value.length)||0," / 150"),n(6),s("",((h=t.form.get("content"))==null||h.value==null?null:h.value.length)||0," / 1000"),n(2),f("disabled",t.submitting),n(2),f("disabled",t.submitting),n(),s(" ",t.data.review?"Update":"Submit"," ")}},dependencies:[C,G,O,z,U,k,F,I,D,P,H,y,R,V,E,T,L,A,j],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:420px}"]});let u=l;return u})();export{ct as a};
