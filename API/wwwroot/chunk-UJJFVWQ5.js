import{b as I,c as re}from"./chunk-KCG5JCIZ.js";import{b as ee}from"./chunk-CLFPZ6VX.js";import{a as S,d as Q}from"./chunk-QLCQQX7Q.js";import{Ga as x,Ha as W,La as C,Ma as X,Oa as F,Qa as u,Ra as Y,Sa as b,Ta as w,Wa as y,Ya as Z,Za as M,_a as N,ca as v,db as E,ea as K,fb as h,gb as _,h as H,hb as te,ib as k,j as G}from"./chunk-NLYTDXKY.js";import{Db as D,Eb as j,Gb as O,Hb as J,Ib as r,Jb as t,Kb as p,Rb as g,Tb as R,Vc as z,Wb as q,bc as a,cb as l,cc as A,db as L,dc as $,jc as f,ka as s,oa as c,wb as T,yb as d}from"./chunk-FFTV7VFC.js";var ie=(()=>{let e=class e{constructor(){this.fb=s(E),this.accountService=s(I),this.router=s(G),this.activatedRoute=s(H),this.returnUrl="/shop",this.loginForm=this.fb.group({email:[""],password:[""]});let n=this.activatedRoute.snapshot.queryParams.returnUrl;n&&(this.returnUrl=n)}onSubmit(){this.accountService.login(this.loginForm.value).subscribe({next:()=>{this.accountService.getUserInfo().subscribe(),this.router.navigateByUrl(this.returnUrl)}})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=c({type:e,selectors:[["app-login"]],standalone:!0,features:[f],decls:15,vars:1,consts:[[1,"max-w-lg","mx-auto","mt-32","p-8","bg-white"],[3,"ngSubmit","formGroup"],[1,"text-center","mb-6"],[1,"text-3xl","font-semibold","text-primary"],["appearance","outline",1,"w-full","mb-4"],["formControlName","email","type","email","placeholder","name@example.com","matInput",""],["formControlName","password","type","password","placeholder","Password","matInput",""],["mat-flat-button","","type","submit",1,"w-full","py-2"]],template:function(o,m){o&1&&(r(0,"mat-card",0)(1,"form",1),g("ngSubmit",function(){return m.onSubmit()}),r(2,"div",2)(3,"h1",3),a(4,"Login"),t()(),r(5,"mat-form-field",4)(6,"mat-label"),a(7,"Email address"),t(),p(8,"input",5),t(),r(9,"mat-form-field",4)(10,"mat-label"),a(11,"Password"),t(),p(12,"input",6),t(),r(13,"button",7),a(14,"Sign in"),t()()()),o&2&&(l(),d("formGroup",m.loginForm))},dependencies:[h,y,F,b,w,M,N,S,C,_,x,v]});let i=e;return i})();function me(i,e){if(i&1&&(r(0,"mat-error"),a(1),t()),i&2){let P=R();l(),$("",P.label," is required")}}function le(i,e){i&1&&(r(0,"mat-error"),a(1,"Email is invalid"),t())}var oe=(()=>{let e=class e{constructor(n){this.controlDir=n,this.label="",this.type="text",this.controlDir.valueAccessor=this}writeValue(n){}registerOnChange(n){}registerOnTouched(n){}get control(){return this.controlDir.control}};e.\u0275fac=function(o){return new(o||e)(L(Y,2))},e.\u0275cmp=c({type:e,selectors:[["app-text-input"]],inputs:{label:"label",type:"type"},standalone:!0,features:[f],decls:6,vars:6,consts:[["appearance","outline",1,"w-full","mb-4"],["matInput","",3,"formControl","type","placeholder"]],template:function(o,m){o&1&&(r(0,"mat-form-field",0)(1,"mat-label"),a(2),t(),p(3,"input",1),T(4,me,2,1,"mat-error")(5,le,2,0,"mat-error"),t()),o&2&&(l(2),A(m.label),l(),q("type",m.type),q("placeholder",m.label),d("formControl",m.control),l(),D(m.control.hasError("required")?4:-1),l(),D(m.control.hasError("email")?5:-1))},dependencies:[h,F,b,Z,C,_,W,x]});let i=e;return i})();function se(i,e){if(i&1&&(r(0,"li"),a(1),t()),i&2){let P=e.$implicit;l(),A(P)}}function pe(i,e){if(i&1&&(r(0,"div",8)(1,"ul",10),O(2,se,2,1,"li",null,j),t()()),i&2){let P=R();l(2),J(P.validationErrors)}}var ne=(()=>{let e=class e{constructor(){this.fb=s(E),this.accountService=s(I),this.router=s(G),this.snack=s(k),this.registerForm=this.fb.group({firstName:["",u.required],lastName:["",u.required],email:["",[u.required,u.email]],password:["",u.required]})}onSubmit(){this.accountService.register(this.registerForm.value).subscribe({next:()=>{this.snack.success("Registration successful - you can now login"),this.router.navigateByUrl("/account/login")},error:n=>this.validationErrors=n})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=c({type:e,selectors:[["app-register"]],standalone:!0,features:[f],decls:12,vars:3,consts:[[1,"max-w-lg","mx-auto","mt-32","p-8","bg-white"],[3,"ngSubmit","formGroup"],[1,"text-center","mb-6"],[1,"text-3xl","font-semibold","text-primary"],["label","First name","formControlName","firstName"],["label","Last name","formControlName","lastName"],["label","Email address","formControlName","email"],["label","Password","formControlName","password","type","password"],[1,"mb-3","p-4","bg-red-100","text-red-600"],["mat-flat-button","","type","submit",1,"w-full","py-2",3,"disabled"],[1,"list-disc","px-3"]],template:function(o,m){o&1&&(r(0,"mat-card",0)(1,"form",1),g("ngSubmit",function(){return m.onSubmit()}),r(2,"div",2)(3,"h1",3),a(4,"Register"),t()(),p(5,"app-text-input",4)(6,"app-text-input",5)(7,"app-text-input",6)(8,"app-text-input",7),T(9,pe,4,0,"div",8),r(10,"button",9),a(11,"Register"),t()()()),o&2&&(l(),d("formGroup",m.registerForm),l(8),D(m.validationErrors?9:-1),l(),d("disabled",m.registerForm.invalid))},dependencies:[h,y,b,w,M,N,S,v,oe]});let i=e;return i})();var ae=(()=>{let e=class e{constructor(){this.fb=s(E),this.accountService=s(I),this.snackbar=s(k),this.profileForm=this.fb.group({firstName:["",u.required],lastName:["",u.required]}),this.passwordForm=this.fb.group({currentPassword:["",u.required],newPassword:["",[u.required,u.minLength(6)]]})}ngOnInit(){let n=this.accountService.currentUser();n?this.profileForm.patchValue({firstName:n.firstName,lastName:n.lastName}):this.accountService.getUserInfo().subscribe({next:o=>this.profileForm.patchValue({firstName:o.firstName,lastName:o.lastName})})}saveProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}this.accountService.updateProfile(this.profileForm.value).subscribe({next:()=>this.snackbar.success("Profile updated"),error:()=>this.snackbar.error("Unable to update profile")})}changePassword(){if(this.passwordForm.invalid){this.passwordForm.markAllAsTouched();return}this.accountService.changePassword(this.passwordForm.value).subscribe({next:()=>{this.snackbar.success("Password changed"),this.passwordForm.reset()},error:n=>{let o=n?.error||"Unable to change password";this.snackbar.error(o)}})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=c({type:e,selectors:[["app-profile"]],standalone:!0,features:[f],decls:35,vars:2,consts:[[1,"max-w-3xl","mx-auto","py-10"],[1,"text-2xl","font-semibold","mb-6"],[1,"mb-6"],[1,"p-4"],[1,"text-xl","font-semibold","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],[1,"md:col-span-2","flex","justify-end"],["mat-flat-button","","color","primary","type","submit"],["matInput","","type","password","formControlName","currentPassword"],["matInput","","type","password","formControlName","newPassword"]],template:function(o,m){o&1&&(r(0,"div",0)(1,"h2",1),a(2,"Account settings"),t(),r(3,"mat-card",2)(4,"div",3)(5,"h3",4),a(6,"Profile"),t(),r(7,"form",5),g("ngSubmit",function(){return m.saveProfile()}),r(8,"mat-form-field",6)(9,"mat-label"),a(10,"First name"),t(),p(11,"input",7),t(),r(12,"mat-form-field",6)(13,"mat-label"),a(14,"Last name"),t(),p(15,"input",8),t(),r(16,"div",9)(17,"button",10),a(18,"Save profile"),t()()()()(),r(19,"mat-card")(20,"div",3)(21,"h3",4),a(22,"Change password"),t(),r(23,"form",5),g("ngSubmit",function(){return m.changePassword()}),r(24,"mat-form-field",6)(25,"mat-label"),a(26,"Current password"),t(),p(27,"input",11),t(),r(28,"mat-form-field",6)(29,"mat-label"),a(30,"New password"),t(),p(31,"input",12),t(),r(32,"div",9)(33,"button",10),a(34,"Update password"),t()()()()()()),o&2&&(l(7),d("formGroup",m.profileForm),l(16),d("formGroup",m.passwordForm))},dependencies:[z,h,y,F,b,w,M,N,Q,S,X,C,x,te,_,K,v,ee],styles:[".mat-mdc-card[_ngcontent-%COMP%]{border:1px solid #e5e7eb}form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{margin-bottom:0}"]});let i=e;return i})();var tt=[{path:"login",component:ie},{path:"register",component:ne},{path:"profile",component:ae,canActivate:[re]}];export{tt as accountRoutes};
